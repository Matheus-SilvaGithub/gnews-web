<h2>üì∞ Not√≠cias</h2>

<div class="controls">

  <!-- üîç Busca -->
  <input
    type="text"
    placeholder="Pesquisar not√≠cias"
    [(ngModel)]="searchTerm"
    (keyup.enter)="search()"
  />

  <button
    (click)="search()"
    [disabled]="!searchTerm.trim() || loading">
    Buscar
  </button>

  @if (isSearchMode) {
    <button (click)="clearSearch()">
      Limpar
    </button>
  }

  <!-- üîÑ Atualizar -->
  <button (click)="refresh()">
    Atualizar
  </button>

  <!-- üìÇ Categoria -->
  <select
    [(ngModel)]="category"
    (change)="loadNews()"
    [disabled]="isSearchMode">

    <option value="general">Geral</option>
    <option value="technology">Tecnologia</option>
    <option value="business">Neg√≥cios</option>
    <option value="sports">Esportes</option>
    <option value="entertainment">Entretenimento</option>
    <option value="health">Sa√∫de</option>
    <option value="science">Ci√™ncia</option>
  </select>

</div>

<!-- ü¶¥ Skeleton loader -->
@if (loading) {
  <div class="grid">
    @for (s of skeletons; track $index) {
      <div class="card skeleton">
        <div class="img"></div>
        <div class="line title"></div>
        <div class="line"></div>
        <div class="line short"></div>
      </div>
    }
  </div>
}

<!-- ‚ùå Erro -->
@if (error) {
  <p class="status error">
    ‚ùå Erro ao carregar not√≠cias. Tente novamente.
  </p>
}

<!-- ‚ö†Ô∏è Vazio -->
@if (!loading && !error && articles.length === 0) {
  <p class="status empty">
    ‚ö†Ô∏è Nenhuma not√≠cia encontrada.
  </p>
}

<!-- üì∞ Lista -->
@if (!loading && articles.length > 0) {
  <div class="grid">
    @for (article of articles; track article.id; let i = $index) {
      <article
        class="card"
        [class.featured]="i === 0">

        @if (article.image) {
          <img
            [src]="article.image"
            [alt]="article.title"
            loading="lazy"
          />
        }

        <h3>{{ article.title }}</h3>

        <small>
          {{ article.publishedAt | date:'dd/MM/yyyy HH:mm' }}
        </small>

        <p>{{ article.description }}</p>

        <a
          [href]="article.url"
          target="_blank"
          rel="noopener">
          Ler mais ‚Üí
        </a>

      </article>
    }
  </div>
}
